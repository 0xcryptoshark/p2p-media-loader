<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">

    <script src="../build/p2p-media-loader-core.js"></script>
    <script src="../build/p2p-media-loader-hlsjs.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.5/mediaelementplayer.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.5/mediaelement-and-player.min.js"></script>

</head>
<body>

    <video id="video"></video>

    <script>

        if (p2pml.hlsjs.Engine.isSupported()) {
            var engine = new p2pml.hlsjs.Engine();

            // allow only one supported renderer
            mejs.Renderers.order = [ "native_hls" ];

            var player = new MediaElementPlayer("video", {
                stretching: "responsive",
                startVolume: 0.01, // 1%
                hls: {
                    liveSyncDurationCount: 7, // To have at least 7 segments in queue
                    loader: engine.createLoaderClass()
                },
                success: function (mediaElement) {
                    p2pml.hlsjs.initMediaElementJsPlayer(mediaElement);
                }
            });

            player.setSrc("https://storage.googleapis.com/shaka-live-assets/player-source.m3u8");
            player.options.forceLive = true;

            player.load();
            player.play();
        } else {
            document.write("Not supported :(");
        }

    </script>

</body>
</html>
